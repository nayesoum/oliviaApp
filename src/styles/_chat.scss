// _chatJournalPage.scss

.chat-journal-layout {
  display: flex;
  flex-direction: column; // Mobile first: topbar puis contenu
  height: 100vh;
  background-color: #121212; // Fond général sombre
  color: #E0E0E0;            // Texte clair par défaut
  overflow: hidden;

  @media (min-width: 768px) { // Desktop
    flex-direction: row;
  }
}

.page-navigation {
  background-color: #1E1E1E; // Fond de la navigation/topbar (légèrement différent du fond général)
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid #2A2A2A; // Bordure subtile
  flex-wrap: wrap;

  .olivia-avatar { // Avatar d'Olivia (partie de OliviaAvatar.js)
    width: 40px; 
    height: 40px;
    margin-right: 1rem;
    border-radius: 8px; // Coins arrondis pour l'avatar d'Olivia
    overflow: hidden;
    img { width: 100%; height: 100%; object-fit: cover; object-position: center top; }
  }

  .chat__voice-toggle, .chat__silent-toggle {
    display: flex;
    align-items: center;
    font-size: 0.8rem;
    margin: 0.25rem 0.5rem;
    
    label { 
        font-size: 0.8rem; 
        display: flex;
        align-items: center;
        gap: 0.3rem;
        color: #B0B0B0; // Couleur pour les labels des toggles
        cursor: pointer;
    }
    input[type="checkbox"] { 
        margin-right: 0.3rem; 
        accent-color: #CBA6F7; // Couleur d'accent pour la checkbox
        cursor: pointer;
    }
    .silent-mode-info { font-size: 0.7rem; color: #888888; margin-left: 0.5rem;}
  }
  
  .history-chat {
    display: none; // Caché sur mobile par défaut
    color: #E0E0E0;
    h3 { font-size: 1rem; margin-bottom: 0.5rem; color: #AAAAAA;}
    .history-item { 
        font-size: 0.85rem; 
        padding: 0.3rem 0.5rem; 
        margin-bottom: 0.3rem; 
        background-color: #252525;
        border-radius: 4px;
        cursor: pointer;
        &:hover { background-color: #333333; }
    }
    .clear-history-btn { 
        font-size: 0.8rem; 
        padding: 0.4rem 0.6rem; 
        margin-top: 0.5rem;
        background-color: #D32F2F; // Rouge pour supprimer
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        &:hover { background-color: #B71C1C; }
    }
  }

  .confirmation-modal {
    position: absolute; 
    top: 60px; // Ajuster en fonction de la hauteur de la topbar
    left: 50%;
    transform: translateX(-50%);
    background: #FFFFFF; 
    color: #333333; 
    padding: 1rem; 
    border-radius: 8px; 
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    z-index: 100;
    min-width: 250px;
    p { margin-bottom: 0.75rem; font-weight: 500; }
    .confirmation-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
        button { 
            padding: 0.4rem 0.8rem; border-radius: 4px; border: none; cursor: pointer;
            &:first-child { background-color: #D32F2F; color: white; } // Oui
            &:last-child { background-color: #CCCCCC; color: #333333; } // Non
        }
    }
  }
  
  .journal-navigation-content {
    display: flex;
    align-items: center;
    .profile-avatar-display {
      width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 1rem;
      border: 2px solid #CBA6F7; // Petite bordure accentuée
    }
    h2 { font-size: 1.1rem; color: #E0E0E0; margin: 0; }
  }


  @media (min-width: 768px) { // Desktop (Sidebar)
    flex-direction: column;
    align-items: stretch; // Pour que les éléments enfants prennent toute la largeur
    justify-content: flex-start;
    width: 280px;
    padding: 1.5rem 1rem;
    border-right: 1px solid #2A2A2A;
    border-bottom: none;
    overflow-y: auto;

    .olivia-avatar { // Avatar d'Olivia en mode sidebar
      width: 150px; 
      height: 150px; 
      margin: 0 auto 1.5rem auto;
      border-radius: 12px;
      img { object-position: center top;}
    }
    .chat__voice-toggle, .chat__silent-toggle {
      font-size: 0.95rem; margin-bottom: 1rem; width: 100%; padding: 0.5rem; border-radius: 6px;
      &:hover { background-color: #252525; }
      label { font-size: 0.95rem; width: 100%; }
    }
    .history-chat { 
        display: block; 
        width: 100%; 
        max-height: 200px; 
        overflow-y: auto; 
        margin-bottom: 1rem;
        background: #1A1A1A; // Fond légèrement différent pour le bloc historique
        padding: 0.75rem; 
        border-radius: 8px;
    }
    .journal-navigation-content {
      flex-direction: column;
      align-items: center;
      text-align: center;
      .profile-avatar-display { width: 100px; height: 100px; margin-bottom: 1rem;}
      h2 { font-size: 1.4rem; margin-top: 0.5rem; }
    }
  }
}

.main-content-area {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background-color: #FEFBF6; // Fond principal clair pour la zone de contenu
}

.mode-switcher {
  display: flex;
  justify-content: stretch;
  gap: 0;
  border-bottom: 1px solid #EAE1D8; // Bordure claire

  button {
    flex-grow: 1;
    background-color: #FDF8F2; // Fond neutre pour les boutons de switch
    color: #777777;      // Couleur de texte pour les boutons inactifs
    border: none;
    padding: 0.8rem 1rem;
    border-radius: 0;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s;
    font-size: 0.9rem;
    text-align: center;

    &.active {
      color: #814CAF; // Couleur d'accent (violet de la page profil) pour le texte actif
      border-bottom-color: #814CAF; // Ligne en dessous pour l'actif
      background-color: #F8F0FF; // Léger fond pour l'actif
    }

    &:hover:not(.active) {
      color: #555555;
      background-color: #F5F5F5;
    }
     @media (min-width: 768px) {
        font-size: 1rem;
        padding: 1rem 1.2rem;
    }
  }
}

.chat-interface-wrapper {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background-color: #FEFBF6; // Fond de la zone des messages du chat
}

.chat-messages-container {
  flex-grow: 1;
  overflow-y: auto;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.message-bubble {
  padding: 0.75rem 1.1rem;
  border-radius: 18px;
  line-height: 1.5; // Hauteur de ligne pour une bonne lisibilité
  word-wrap: break-word; // ou overflow-wrap: break-word; pour couper les mots longs
  max-width: 75%; // Garder cette contrainte pour la largeur
  color: #FFFFFF; 

  // Styles pour les paragraphes <p> à l'intérieur de N'IMPORTE QUELLE bulle
  p {   
    margin-top: 0; // Enlève la marge du haut par défaut des <p>
    margin-bottom: 0.75em; // Ajoute un espace en dessous de chaque paragraphe
                           // 0.75em est relatif à la taille de la police, ajuste si besoin

    &:last-child {
      margin-bottom: 0; // Le dernier paragraphe dans une bulle n'a pas besoin de marge en bas
    } 
    strong {
      font-weight: 600; // Ou 700 si tu préfères un gras plus marqué
    }
  }

  &.user-message {
    background-color: #814CAF; // Violet pour les messages utilisateur (cohérent avec l'accent)
    margin-left: auto;
    border-bottom-right-radius: 6px;
     p {
       white-space: pre-line; // Conserve les sauts de ligne et les séquences d'espaces pour le formatage
     }
  }

  &.ai-message {
    background-color: #3A3A3C; // Gris foncé pour les messages IA
    color: #E0E0E0; // Texte clair sur fond foncé
    margin-right: auto;
    border-bottom-left-radius: 6px;
  
    .chat-list-item {
      padding-left: 20px; // Ajuste cette valeur pour l'indentation souhaitée
      // Tu pourrais aussi utiliser margin-left si tu préfères.
      // Le marqueur de liste (•, 1., etc.) est conservé dans le texte,
      // donc pas besoin de `list-style-type` ici, sauf si tu voulais le remplacer.
    }
  }
}

.chat-input-area {
  display: flex;
  align-items: flex-end; // Aligner le bouton avec le bas du textarea quand il grandit
  padding: 0.75rem 1rem;
  border-top: 1px solid #EAE1D8; // Bordure claire
  background-color: #FDF8F2; // Fond de la zone d'input

  textarea {
    flex-grow: 1;
    padding: 0.75rem 1rem; // Padding interne du textarea
    border-radius: 20px;
    border: 1px solid #D1C7BC;
    resize: none;
    font-family: inherit;
    font-size: 1rem;
    background-color: #FFFFFF;
    color: #222222;
    margin-right: 0.75rem;
    min-height: 48px;
    max-height: 120px;
    overflow-y: auto;
    line-height: 1.4; // Pour un meilleur espacement vertical du texte
  }

  button {
    background-color: #814CAF; // Couleur d'accent pour le bouton d'envoi
    color: white;
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    font-size: 1.5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
    flex-shrink: 0; // Empêche le bouton de rétrécir

    &:hover {
      background-color: #6B3F92; // Accent plus foncé au survol
    }
    &:disabled {
        background-color: #B0B0B0; // Gris pour bouton désactivé
        cursor: not-allowed;
    }
  }
}

.chat-confirmation-prompt {
    background-color: #F8F0FF; // Fond clair accentué
    padding: 1rem;
    margin: 0.5rem 1rem;
    border-radius: 8px;
    text-align: center;
    p { margin: 0 0 0.75rem 0; color: #333333;}
    button {
        margin: 0 0.5rem; padding: 0.6rem 1.2rem; border-radius: 6px; border: none; cursor: pointer; font-weight: 500;
        &:first-of-type { background-color: #814CAF; color: white; }
        &:last-of-type { background-color: #E0E0E0; color: #333333; }
    }
}

.modal-backdrop {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.6);
    display: flex; align-items: center; justify-content: center;
    z-index: 1000;
}
.emergency-modal-content {
    background: #FFFFFF; color: #333333;
    padding: 1.5rem 2rem; border-radius: 12px; text-align: center;
    max-width: 400px; width: calc(100% - 2rem); margin: 1rem; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    h2 { margin-top: 0; margin-bottom: 1rem; color: #D32F2F; } // Rouge pour le titre d'urgence
    strong { color: #D32F2F; }
    button { 
        margin-top: 1.2rem; 
        padding: 0.7rem 1.2rem; 
        border-radius: 8px; 
        cursor: pointer; 
        font-weight: 500;
        border: none;
    }
    .btn-urgence-action { background-color: #D32F2F; color: white; margin-right: 0.5rem; }
    // Le bouton fermer
    button:not(.btn-urgence-action) { background-color: #E0E0E0; color: #333333; }
}